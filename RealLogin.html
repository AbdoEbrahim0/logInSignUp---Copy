<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<link rel="stylesheet" href="https://unpkg.com/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>

<!-- Login 2 - Bootstrap Brain Component -->
<h2 class="text-center" id="login-message" > my message here</h2>
<!-- to make page resposive when zoom in  out  -->
<div class="bg-light py-3 py-md-5  min-vh-100"> 
  <div class="container">
    <div class="row justify-content-md-center">
      <div class="col-12 col-md-11 col-lg-8 col-xl-7 col-xxl-6">
        <div class="bg-white p-4 p-md-5 rounded shadow-sm">
          <div class="row">
            <div class="col-12">
              <div class="mb-5">
                <h3 class="h3 text-center">Log in</h3>
                <h3 class="fs-6 fw-normal text-secondary text-center m-0 text-muted">
                  Please Enter your Data
                </h3>
              </div>
            </div>
          </div>
          <form  id="login-form"  action="#!">
            <div class="row gy-3 gy-md-4 overflow-hidden">
              <div class="col-12">
                <label for="email" class="form-label"
                  >Email <span class="text-danger">*</span></label
                >
                <input
                  type="email"
                  class="form-control"
                  name="email"
                  id="login-email"
                  placeholder="Abdelrahman@example.com"
                  required
                />
              </div>
              <div class="col-12">
                <label for="password" class="form-label"
                  >Password <span class="text-danger">*</span></label
                >
                <input
                  type="password"
                  class="form-control"
                  name="password"
                  id="login-password"
                  value=""
                  required
                />
              </div>
              <div class="col-12">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value=""
                    name="remember_me"
                    id="remember_me"
                  />
                  <label
                    class="form-check-label text-secondary"
                    for="remember_me"
                  >
                    Keep me logged in
                  </label>
                </div>
              </div>
              <div class="col-12">
                <div class="d-grid">
                  <button class="btn btn-lg btn-primary" type="submit">
                    Log in now
                  </button>
                </div>
              </div>
            </div>
          </form>
          <div class="row">
            <div class="col-12">
              <hr class="mt-5 mb-4 border-secondary-subtle" />
              <div
                class="d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-end"
              >
                <a href="./Register.html" class="text-muted text-decoration-none"
                  >Create new account</a
                >
                <a href="#!" class="text-muted text-decoration-none"
                  >Forgot password</a
                >
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  
const supabaseUrl = 'https://qsmvtalwscuvqktjlleq.supabase.co'
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFzbXZ0YWx3c2N1dnFrdGpsbGVxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0MDI3MjksImV4cCI6MjA4Njk3ODcyOX0.GVZ6I2nYwqq5q0i9tehslYEDwxDBsWv1JO9_MzBn7yk'
 supabase = window.supabase.createClient(supabaseUrl, supabaseKey)



document.getElementById('login-form').addEventListener('submit', async (e) => {
  e.preventDefault(); 
  
  const email = document.getElementById('login-email').value;
  const password = document.getElementById('login-password').value;
  const messageEl = document.getElementById('login-message');

  // Call Supabase to log the user in
  const { data, error } = await supabase.auth.signInWithPassword({
    email: email,
    password: password,
  });

  if (error) {
    messageEl.textContent = 'Error: ' + error.message +' Or make sure have account';
    messageEl.style.color = 'red';
  } 
  
  else {
    const { data: { user } } = await supabase.auth.getUser();
console.log(user.user_metadata.fName, user.user_metadata.lName);

    messageEl.textContent = `Welcome back! ${user.user_metadata.fName} ${user.user_metadata.lName}`  ;
    messageEl.style.color = 'green';
    
    // You can now redirect the user to a dashboard page
    // window.location.href = '/dashboard.html';
  }
});
</script>

</body>
</html>
